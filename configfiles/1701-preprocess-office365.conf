# SOF-ELKÂ® Configuration File
# (C)2020 Lewes Technology Consulting, LLC
#
# This file contains preprocessors for Microsoft Office 365 logs

filter {
  if [type] == "office365" {
    # Need to drop that pesky second header
    if [message] =~ /^#/ {
      drop {}

    } else if [message] =~ /^CreationDate,UserIds,Operations,AuditData/ {
      drop {}

    } else if ([message] =~ /^PSComputerName,RunspaceId,PSShowComputerName,RecordType,CreationDate,UserIds,Operations,AuditData,ResultIndex,ResultCount,Identity,IsValid,ObjectState/) {
      drop {}
    }
  }
}
