# SOF-ELKÂ® Configuration File
# (C)2019 Lewes Technology Consulting, LLC
#
# This file creates a filebeat prospector for source data from the KAPE forensic tool

- type: log
  paths:
    - /logstash/kape/*/*/*/*/FileSystem/*_MFTECmd_Output.json
    - /logstash/kape/*/*/*/FileSystem/*_MFTECmd_Output.json
    - /logstash/kape/*/*/FileSystem/*_MFTECmd_Output.json
    - /logstash/kape/*/FileSystem/*_MFTECmd_Output.json
    - /logstash/kape/FileSystem/*_MFTECmd_Output.json
  close_inactive: 5m
  fields_under_root: true
  fields:
    type: kape_filesystem
  tags: [ 'json' ]

- type: log
  paths:
    - /logstash/kape/*/*/*/*/FileFolderAccess/*_LECmd_Output.json
    - /logstash/kape/*/*/*/FileFolderAccess/*_LECmd_Output.json
    - /logstash/kape/*/*/FileFolderAccess/*_LECmd_Output.json
    - /logstash/kape/*/FileFolderAccess/*_LECmd_Output.json
    - /logstash/kape/FileFolderAccess/*_LECmd_Output.json
  close_inactive: 5m
  fields_under_root: true
  fields:
    type: kape_lnkfiles
  tags: [ 'json' ]

- type: log
  paths:
    - /logstash/kape/*/*/*/*/FileFolderAccess/*.json
    - /logstash/kape/*/*/*/FileFolderAccess/*.json
    - /logstash/kape/*/*/FileFolderAccess/*.json
    - /logstash/kape/*/FileFolderAccess/*.json
    - /logstash/kape/FileFolderAccess/*.json
  close_inactive: 5m
  fields_under_root: true
  fields:
    type: kape_filefolderaccess
  tags: [ 'json' ]
